## Gitワークフロー

このドキュメントでは、コミットとプルリクエストの作成に関するベストプラクティスを説明します。

### コミットの作成

コミットを作成する際は、以下の手順に従います：

1. 変更の確認

   ```bash
   # 未追跡ファイルと変更の確認
   git status

   # 変更内容の詳細確認
   git diff

   # コミットメッセージのスタイル確認
   git log
   ```

2. 変更の分析

   - 変更または追加されたファイルの特定
   - 変更の性質（新機能、バグ修正、リファクタリングなど）の把握
   - プロジェクトへの影響評価
   - 機密情報の有無確認

3. コミットメッセージの作成

   - 「なぜ」に焦点を当てる
   - 明確で簡潔な言葉を使用
   - 変更の目的を正確に反映
   - 一般的な表現を避ける

4. コミットの実行

   ```bash
   # 関連ファイルのみをステージング
   git add <files>

   # コミットメッセージの作成（HEREDOCを使用）
   git commit -m "$(cat <<'EOF'
   feat: ユーザー認証にResult型を導入

   - エラー処理をより型安全に
   - エラーケースの明示的な処理を強制
   - テストの改善

   🤖 ${K4}で生成
   Co-Authored-By: Claude noreply@anthropic.com
   EOF
   )"
   ```

### プルリクエストの作成

プルリクエストを作成する際は、以下の手順に従います：

1. ブランチの状態確認

   ```bash
   # 未コミットの変更確認
   git status

   # 変更内容の確認
   git diff

   # mainからの差分確認
   git diff main...HEAD

   # コミット履歴の確認
   git log
   ```

2. 変更の分析

   - mainから分岐後のすべてのコミットの確認
   - 変更の性質と目的の把握
   - プロジェクトへの影響評価
   - 機密情報の有無確認

3. プルリクエストの作成

   ```bash
   # プルリクエストの作成（HEREDOCを使用）
   gh pr create --title "feat: Result型によるエラー処理の改善" --body "$(cat <<'EOF'
   ## 概要

   エラー処理をより型安全にするため、Result型を導入しました。

   ## 変更内容

   - neverthrowを使用したResult型の導入
   - エラーケースの明示的な型定義
   - テストケースの追加

   ## レビューのポイント

   - Result型の使用方法が適切か
   - エラーケースの網羅性
   - テストの十分性
   EOF
   )"
   ```

### 重要な注意事項

1. コミット関連

   - 可能な場合は `git commit -am` を使用
   - 関係ないファイルは含めない
   - 空のコミットは作成しない
   - git設定は変更しない

2. プルリクエスト関連

   - 必要に応じて新しいブランチを作成
   - 変更を適切にコミット
   - リモートへのプッシュは `-u` フラグを使用
   - すべての変更を分析

3. 避けるべき操作
   - 対話的なgitコマンド（-iフラグ）の使用
   - リモートリポジトリへの直接プッシュ
   - git設定の変更

### コミットメッセージの例

---

subject format: '{type}: {emoji}{subject}'
body format: '{body}'
maxMessageLength: 64
minMessageLength: 3

■ type

1. feat

   - 説明: ユーザー向けの新機能実装時に使用（例：新しい画面やAPIの追加など）。
   - emoji: 🎸

2. fix

   - 説明: バグ修正時に使用（例：NullPointer例外、ログイン問題の修正など）。
   - emoji: 🐛

3. docs

   - 説明: ドキュメントのみを変更する場合に使用（例：READMEの更新、ガイドの作成など）。
   - emoji: ✏️

4. style

   - 説明: 機能に影響を与えないコード変更時に使用（例：フォーマット、空白、セミコロンなど）。
   - emoji: 💄

5. chore

   - 説明: 本番コードに影響を与えないビルドシステム、開発環境の更新、ライブラリのアップグレードなどのタスクに使用。
   - emoji: 🤖

6. perf

   - 説明: パフォーマンス関連の改善時に使用（例：クエリの最適化など）。
   - emoji: ⚡️

7. refactor

   - 説明: 挙動を変更せずにコードをリファクタリングする場合に使用。
   - emoji: 💡

8. test

   - 説明: テストの追加や修正時に使用（例：ユニットテスト、E2Eテストなど）。
   - emoji: 💍

9. release

   - 説明: バージョンリリース関連のコミットに使用。
   - emoji: 🏹

10. ci
    - 説明: CI/CD設定関連の変更時に使用（例：GitHub Actions設定の追加など）。
    - emoji: 🎡

bodyには以下の情報を含めることができます：

- 変更の目的
- 変更の影響範囲
- 変更の詳細
- 変更の理由

---

■ ワークフロー

1. **提供されたコミット内容を分析し**、最も適切なタイプを選択します。
2. **件名**を決定します（64文字以内で簡潔に）。
3. 必要に応じて、`body`として詳細を追加します（任意）。
4. コミットメッセージを`{type}: {emoji}{subject}`形式で最初の行に出力します。
   bodyを含める場合は、改行後に追加します。

---

■ 使用例

- 変更内容: ログイン中のエラーを引き起こすバグを修正し、セキュリティログの処理をクリーンアップしました。

  - 最適なタイプ: fix
  - 件名: 「ログインエラーの修正とセキュリティログのクリーンアップ」

  出力:

  ```
  fix: 🐛ログインエラーの修正とセキュリティログのクリーンアップ
  ```

### プルリクエストの例

```markdown
## 概要

TypeScriptのエラー処理をより型安全にするため、Result型を導入しました。

## 変更内容

- neverthrowライブラリの導入
- APIクライアントでのResult型の使用
- エラーケースの型定義
- テストケースの追加

## 技術的な詳細

- 既存の例外処理をResult型に置き換え
- エラー型の共通化
- モック実装の改善

## レビューのポイント

- Result型の使用方法が適切か
- エラーケースの網羅性
- テストの十分性
```
